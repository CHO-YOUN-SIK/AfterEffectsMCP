<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>AfterEffects MCP</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- External CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- Collapsible API Key Section -->
    <div id="api-section">
        <div class="api-header" onclick="toggleApiSection()">
            <div style="display:flex; align-items:center; gap:8px;">
                <span>ğŸ”‘ Gemini API Key</span>
                <span id="server-status-dot" class="status-dot disconnected" title="ì„œë²„ ì—°ê²° ìƒíƒœ"></span>
            </div>
            <span class="api-toggle">â–¼</span>
        </div>
        <div class="api-content">
            <label>API Key</label>
            <div style="display: flex; gap: 10px;">
                <input type="password" id="apiKeyInput" placeholder="Enter your Gemini API Key..." style="flex: 1;">
                <button id="testApiBtn" class="api-test-btn" onclick="testApiKey()">í…ŒìŠ¤íŠ¸</button>
            </div>
            <div id="apiStatus" class="api-status"></div>
        </div>
    </div>

    <!-- Main Chat Container -->
    <div id="chat-container">
        <!-- Welcome Message -->
        <div class="system-msg">
            ğŸ‘‹ ì•ˆë…•í•˜ì„¸ìš”! After Effects ì‘ì—…ì„ ë„ì™€ë“œë¦´ ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>
    </div>

    <!-- Input Area -->
    <div id="input-area">
        <div class="quick-actions">
            <!-- File Upload Button -->
            <button class="icon-btn" title="íŒŒì¼ ì²¨ë¶€" onclick="handleFileUpload()">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
                </svg>
            </button>
        </div>
        <textarea id="promptInput" rows="1" placeholder="ë¬´ì—‡ì„ ë§Œë“¤ê¹Œìš”? (Shift+Enter ì¤„ë°”ê¿ˆ)"></textarea>
        <button id="sendBtn" title="ì „ì†¡">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
            </svg>
        </button>
    </div>

    <script src="../lib/CSInterface.js"></script>
    <script src="main.js"></script>

    <script>
        // Toggle API Section
        function toggleApiSection() {
            const section = document.getElementById('api-section');
            section.classList.toggle('collapsed');
        }

        // Handle Enter key for Textarea
        const promptInput = document.getElementById('promptInput');
        promptInput.addEventListener('keydown', function (e) { // changed to keydown from keypress for consistency
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                document.getElementById('sendBtn').click();
            }
        });

        // Placeholder for file upload
        function handleFileUpload() {
            alert('íŒŒì¼ ì²¨ë¶€ ê¸°ëŠ¥ì€ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤!');
        }

        // Auto-scroll to bottom when new message arrives (Helper)
        function scrollToBottom() {
            const container = document.getElementById('chat-container');
            container.scrollTop = container.scrollHeight;
        }
    </script>
</body>

</html>